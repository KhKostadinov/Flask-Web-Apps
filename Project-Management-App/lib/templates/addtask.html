{% extends 'project.html' %}

{% block tasks %}
<div>
    {% if task %}
    <form action="{{ url_for('task_routes.edit',task_id=task.id) }}" class="form" method="post">
        <div class="form-floating mb-3">
            <input type="text" class="form-control" placeholder="someplace" id="floatingInput" name="tasktitle" value="{{ task.title }}"/>
            <label for="floatingInput">{{ task.title }}</label>
        </div>
        <div class="form-floating">
          <textarea class="form-control" placeholder="someplace" name="taskdescription" id="floatingTextarea2" style="height: 80px">{{ task.description }}</textarea>
          <label for="floatingTextarea2">Describe your task here</label>
        </div>
            <table class="table table-hover table-bordered" style="margin-top: 4px;">
              <tbody>
              <tr>
                  <td>Status: </td>
                  <td>
                      <select class="form-select btn-outline-secondary" aria-label="Status select" name="taskstatus">
                        <option selected>{{ task.status }}</option>
                          <option value="Idle">Idle</option>
                        <option value="In progress">In progress</option>
                        <option value="Completed">Completed</option>
                      </select>
                  </td>
              </tr>
              <tr>
                  <td>Due Date: </td>
                  <td>
                    <link rel="stylesheet" href="{{ url_for('static',filename='dpicker/jquery.datetimepicker.min.css') }}" />
                    <script src="{{ url_for('static',filename='dpicker/jquery.js') }}"></script>
                    <script src="{{ url_for('static',filename='dpicker/jquery.datetimepicker.full.js') }}"></script>
                    <input id="datetime" name="duedate" class="btn btn-outline-secondary" value="{{ task.due_date }}" style="width: 100%;">
                    <script>
                        $("#datetime").datetimepicker();
                    </script>
                  </td>
              </tr>
              <tr>
                  <td>Assigned to: </td>
                  <td>
                    <select class="form-select btn-outline-secondary" aria-label="Teammate select" name="teammate">
                        {% if assig.id != 1 %}
                        <option selected value="{{ assig.id }}">{{ assig.fname }}</option>      
                        {% endif %}
                        {% for mate in team %}
                          <option value="{{ mate.id }}">{{ mate.fname }}</option>
                        {% endfor %}
                    </select>
                  </td>
              </tr>
              <tr>
                  <td>Importance: </td>
                  <td>
                    <select class="form-select btn-outline-secondary" aria-label="Importance select" name="importance">
                        <option selected>{{ task.importance }}</option>
                        <option value="Low">Low</option>
                        <option value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                  </td>
              </tr>
              </tbody>
            </table>
            <input type="submit" value="Save changes" class="btn btn-outline-dark">
            <a href="{{ url_for('project_routes.project',project_id=project.id) }}" class="btn btn-outline-dark" role="button">Cancel</a>
    </form>
    <form action="{{ url_for('task_routes.delete_task',task_id=task.id) }}" method="POST">
        <input class="btn btn-danger" type="submit" value="Delete Task">
    </form>
    {% else %}
        <form action="{{ url_for('task_routes.add',project_id=project.id) }}" class="form" method="post">
        <div class="form-floating mb-3">
            <input type="text" class="form-control" placeholder="someplace" id="floatingInput" name="tasktitle" />
            <label for="floatingInput">Task title</label>
        </div>
        <div class="form-floating">
          <textarea class="form-control" placeholder="someplace" name="taskdescription" id="floatingTextarea2" style="height: 80px"></textarea>
          <label for="floatingTextarea2">Describe your task here</label>
        </div>
            <table class="table table-hover table-bordered" style="margin-top: 4px;">
              <tbody>
              <tr>
                  <td>Status: </td>
                  <td>
                      <select class="form-select btn-outline-secondary" aria-label="Status select" name="taskstatus">
                        <option selected>Idle</option>
                        <option value="In progress">In progress</option>
                        <option value="Completed">Completed</option>
                      </select>
                  </td>
              </tr>
              <tr>
                  <td>Due Date: </td>
                  <td>
                    <link rel="stylesheet" href="{{ url_for('static',filename='dpicker/jquery.datetimepicker.min.css') }}" />
                    <script src="{{ url_for('static',filename='dpicker/jquery.js') }}"></script>
                    <script src="{{ url_for('static',filename='dpicker/jquery.datetimepicker.full.js') }}"></script>
                    <input id="datetime" name="duedate" class="btn btn-outline-secondary" value="YY/MM/DD HH:MM" style="width: 100%;">
                    <script>
                        $("#datetime").datetimepicker();
                    </script>
                  </td>
              </tr>
              <tr>
                  <td>Assign to: </td>
                  <td>
                     <select class="form-select btn-outline-secondary" aria-label="Teammate select" name="teammate">
                         {% for mate in team %}
                            <option value="{{ mate.id }}">{{ mate.fname }}</option>
                         {% endfor %}
                    </select>
                  </td>
              </tr>
              <tr>
                  <td>Importance: </td>
                  <td>
                    <select class="form-select btn-outline-secondary" aria-label="Importance select" name="importance">
                        <option value="Low">Low</option>
                        <option selected value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                  </td>
              </tr>
              </tbody>
            </table>
            <input type="submit" value="Add task" class="btn btn-outline-dark">
            <a href="{{ url_for('project_routes.project',project_id=project.id) }}" class="btn btn-outline-dark" role="button">Cancel</a>
        </form>
    {% endif %}
</div>

{% endblock %}
